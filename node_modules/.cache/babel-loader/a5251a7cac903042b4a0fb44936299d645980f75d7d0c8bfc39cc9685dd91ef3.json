{"ast":null,"code":"import _slicedToArray from\"/home/tome/lighthouse/projectG/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useRef,useState,useEffect}from'react';import{startDrawing,draw,stopDrawing,clearCanvas}from'./canvasUtils';import{Link}from'react-router-dom';import{startMatch}from'../game/features/turns/turn';import{useDispatch,useSelector}from'react-redux';import{addCanvasDrawing}from'./canvasDrawingSlice';import{setImage}from'../game/features/board/boardSlice';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var CanvasComponent=function CanvasComponent(_ref){var startTimer=_ref.startTimer,intervalRef=_ref.intervalRef,remainingTime=_ref.remainingTime;var canvasRef=useRef(null);var _useState=useState(false),_useState2=_slicedToArray(_useState,2),isDrawing=_useState2[0],setIsDrawing=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),isEraserMode=_useState4[0],setIsEraserMode=_useState4[1];var _useState5=useState(0),_useState6=_slicedToArray(_useState5,2),lastX=_useState6[0],setLastX=_useState6[1];var _useState7=useState(0),_useState8=_slicedToArray(_useState7,2),lastY=_useState8[0],setLastY=_useState8[1];var _useState9=useState(false),_useState10=_slicedToArray(_useState9,2),isTimerStarted=_useState10[0],setIsTimerStarted=_useState10[1];var canvasDrawings=useSelector(function(state){return state.canvasDrawings;});var handleMouseDown=function handleMouseDown(e){if(!isDrawing){startDrawing(isDrawing,setIsDrawing,setLastX,setLastY,e);if(!isTimerStarted){startTimer();// Start the timer on the first mousedown\nsetIsTimerStarted(true);// Set the timer started flag to true\n}}};var handleMouseMove=function handleMouseMove(e){draw(isDrawing,isEraserMode,lastX,lastY,setLastX,setLastY,e,canvasRef.current);};var handleMouseUp=function handleMouseUp(){stopDrawing(setIsDrawing);};var handleMouseOut=function handleMouseOut(){stopDrawing(setIsDrawing);};var toggleEraserMode=function toggleEraserMode(){setIsEraserMode(!isEraserMode);};var toggleClearCanvas=function toggleClearCanvas(){clearCanvas(canvasRef);};var saveCanvasDrawing=function saveCanvasDrawing(){// Your code to capture and save the canvas drawing goes here\nvar canvas=canvasRef.current;var context=canvas.getContext('2d');var imageData=canvas.toDataURL();// Get the base64 encoded image data\n// Now, you can do whatever you want with the captured drawing data, e.g., send it to a server, save it in state, etc.\ndispatch(addCanvasDrawing(imageData));};var dispatch=useDispatch();var startGameHandler=function startGameHandler(){// Add action dispatch below\ndispatch(startMatch());dispatch(setImage(canvasDrawings));};useEffect(function(){var currentIntervalRef=intervalRef.current;// Capture the current value\nreturn function(){clearInterval(currentIntervalRef);// Clear the interval on unmount\n};},[intervalRef]);// Make sure to include intervalRef in the dependency array\nvar saveAndClearCanvas=function saveAndClearCanvas(){saveCanvasDrawing();// Save the canvas drawing\ntoggleClearCanvas();// Clear the canvas\n};// This useEffect runs whenever the timer reaches 1\nuseEffect(function(){if(remainingTime===1){saveAndClearCanvas();}},[remainingTime]);return/*#__PURE__*/_jsxs(\"div\",{className:\"canvas\",children:[/*#__PURE__*/_jsx(\"canvas\",{ref:canvasRef,width:800,height:600,onMouseDown:handleMouseDown,onMouseMove:handleMouseMove,onMouseUp:handleMouseUp,onMouseOut:handleMouseOut}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"button\",{onClick:toggleEraserMode,className:\"draw-erase\",children:isEraserMode?'Draw':'Erase'}),/*#__PURE__*/_jsx(\"button\",{onClick:toggleClearCanvas,className:\"Clear-canvas\",children:\"Clear Drawing\"}),/*#__PURE__*/_jsx(\"button\",{onClick:saveCanvasDrawing,children:\"Save Drawing\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"playButton\",children:/*#__PURE__*/_jsx(Link,{to:\"/game\",className:\"button-link\",onClick:startGameHandler,children:/*#__PURE__*/_jsx(\"h2\",{children:\"Next\"})})})]});};export default CanvasComponent;","map":{"version":3,"names":["React","useRef","useState","useEffect","startDrawing","draw","stopDrawing","clearCanvas","Link","startMatch","useDispatch","useSelector","addCanvasDrawing","setImage","jsx","_jsx","jsxs","_jsxs","CanvasComponent","_ref","startTimer","intervalRef","remainingTime","canvasRef","_useState","_useState2","_slicedToArray","isDrawing","setIsDrawing","_useState3","_useState4","isEraserMode","setIsEraserMode","_useState5","_useState6","lastX","setLastX","_useState7","_useState8","lastY","setLastY","_useState9","_useState10","isTimerStarted","setIsTimerStarted","canvasDrawings","state","handleMouseDown","e","handleMouseMove","current","handleMouseUp","handleMouseOut","toggleEraserMode","toggleClearCanvas","saveCanvasDrawing","canvas","context","getContext","imageData","toDataURL","dispatch","startGameHandler","currentIntervalRef","clearInterval","saveAndClearCanvas","className","children","ref","width","height","onMouseDown","onMouseMove","onMouseUp","onMouseOut","onClick","to"],"sources":["/home/tome/lighthouse/projectG/src/pages/canvas/canvas.js"],"sourcesContent":["import React, { useRef, useState, useEffect } from 'react';\nimport { startDrawing, draw, stopDrawing, clearCanvas } from './canvasUtils';\nimport { Link } from 'react-router-dom';\nimport { startMatch } from '../game/features/turns/turn';\nimport { useDispatch, useSelector } from 'react-redux';\nimport { addCanvasDrawing } from './canvasDrawingSlice';\nimport { setImage } from '../game/features/board/boardSlice';\n\nconst CanvasComponent = ({ startTimer, intervalRef, remainingTime }) => {\n  const canvasRef = useRef(null);\n  const [isDrawing, setIsDrawing] = useState(false);\n  const [isEraserMode, setIsEraserMode] = useState(false);\n  const [lastX, setLastX] = useState(0);\n  const [lastY, setLastY] = useState(0);\n  const [isTimerStarted, setIsTimerStarted] = useState(false);\n  const canvasDrawings = useSelector(state => state.canvasDrawings);\n  const handleMouseDown = (e) => {\n    if (!isDrawing) {\n      startDrawing(isDrawing, setIsDrawing, setLastX, setLastY, e);\n      \n      if (!isTimerStarted) {\n        startTimer(); // Start the timer on the first mousedown\n        setIsTimerStarted(true); // Set the timer started flag to true\n      }\n    }\n  };  \n\n  const handleMouseMove = (e) => {\n    draw(isDrawing, isEraserMode, lastX, lastY, setLastX, setLastY, e, canvasRef.current);\n  };\n\n  const handleMouseUp = () => {\n    stopDrawing(setIsDrawing);\n  };\n\n  const handleMouseOut = () => {\n    stopDrawing(setIsDrawing);\n  };\n\n  const toggleEraserMode = () => {\n    setIsEraserMode(!isEraserMode);\n  };\n\n  const toggleClearCanvas = () => {\n    clearCanvas(canvasRef);\n  };\n\n  const saveCanvasDrawing = () => {\n    // Your code to capture and save the canvas drawing goes here\n    const canvas = canvasRef.current;\n    const context = canvas.getContext('2d');\n    const imageData = canvas.toDataURL(); // Get the base64 encoded image data\n    // Now, you can do whatever you want with the captured drawing data, e.g., send it to a server, save it in state, etc.\n    \n    dispatch(addCanvasDrawing(imageData));\n  };\n\n  const dispatch = useDispatch();\n  \n  const startGameHandler = () => {\n    // Add action dispatch below\n    dispatch(startMatch());\n    dispatch(setImage(canvasDrawings))\n  };\n\n  useEffect(() => {\n    const currentIntervalRef = intervalRef.current; // Capture the current value\n    return () => {\n      clearInterval(currentIntervalRef); // Clear the interval on unmount\n    };\n  }, [intervalRef]); // Make sure to include intervalRef in the dependency array\n  \n  const saveAndClearCanvas = () => {\n    saveCanvasDrawing(); // Save the canvas drawing\n    toggleClearCanvas(); // Clear the canvas\n  };\n\n  // This useEffect runs whenever the timer reaches 1\n  useEffect(() => {\n    if (remainingTime === 1) {\n      saveAndClearCanvas();\n    }\n  }, [remainingTime]);\n\n\n  return (\n    <div className='canvas'>\n      <canvas\n        ref={canvasRef}\n        width={800}\n        height={600}\n        onMouseDown={handleMouseDown}\n        onMouseMove={handleMouseMove}\n        onMouseUp={handleMouseUp}\n        onMouseOut={handleMouseOut}\n      />\n      <div>\n        <button onClick={toggleEraserMode} className='draw-erase'>\n          {isEraserMode ? 'Draw' : 'Erase'}\n        </button>\n        <button onClick={toggleClearCanvas} className='Clear-canvas'>\n          Clear Drawing\n        </button>\n        <button onClick={saveCanvasDrawing}>Save Drawing</button>\n      </div>\n\n      <div className='playButton'>\n        <Link to='/game' className='button-link' onClick={startGameHandler}>\n          <h2>Next</h2>\n        </Link>\n      </div>\n    </div>\n  );\n};\n\nexport default CanvasComponent;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}